rsa.py
------

This Python script encrypts and decrypts files based on RSA public key
cryptography.

 

Requirements to run:

-   Python 3.7

-   PyCryptodome for the cryptographic functionality. This library needs to be
    installed without conflicts including those with PyCrypto. Using a python
    virtualenv is the safest way to get this library without conflicts as it
    will be the only 3rd party library installed. See [this
    article](https://robots.thoughtbot.com/how-to-manage-your-python-projects-with-pipenv)
    for a great guide on how to get one up and running.

 

### Usage:

./rsa.py to generate key pair

./rsa.py -e \<file path\> \<public key\> to encrypt the file at the specified
file path

./rsa.py -d \<file path\> \<private key\> to decrypt the file at the specified
file path

 

### References:

The usage examples of PyCryptodome found at
<https://pycryptodome.readthedocs.io/en/latest/src/examples.html>

 

### Example Usage:

(pycryptodome_pipenv) bash-3.2\$ cat data.txt 

confidential information

(pycryptodome_pipenv) bash-3.2\$ ./rsa.py 

RSA PRIVATE KEY:

2d2d2d2d2d424547494e205253412050524956415445204b45592d2d2d2d2d0a4d4949456f77494241414b43415145417a524a634f3671472f576e482f384d376f7157436a717168315558397a536a73394245496a4f2b7a52546a4d4a5378750a6f64446c79466d7a50565053672b54417835414b4d7775636d586562655a2f31646d7a36577a66364f454f632f635a444367444c6856454e6a4f344b303946320a6a47414d30494269785a7870686a502f64352b686b30396e6e5331756f50656a4571585442386b654a4a47626f334e43557150485434457a6d6e386a483472440a704448557750696765547a697a33742f4255513661516a50796b75535634736b435139384e6158396644525a386242746b2f343771765236546b48786c356a2f0a646962333845596965642f363345366b4939325a314c4f58746854612f4776465959736e5452355161556b63335a4462322b6c365545455a794c586f53736d500a5062746a34435532596a48394f6a397463325165416136724b3566684250414a76656f444f51494441514142416f494241426e61642f624d755a352b704d68310a6a6c486a77466b6f6f57547749543570613741636171484d41574f58644d4d312f672b58394c516b764f42644c6a5054466376432b4d6f314b303238777354620a576669505a694f305936384f74523759545444595a3141634a784e756d6a35596b4c5044557a4a4245564b38394a2f47382b7a616d75586c73356767393272440a4e5a4f66424d4d64513566554a4a552f625776614f6f456e4e6f434354327a33474c5a66645879437244586279385a51364a4b3973565068782f4535635759550a4c4d6f34632f74384a412b736c4e2b666f572f464f693442384a6a7875774b31747673783847734f5950487a6e545949492b37756345574d35715164484953340a303566494d73767958466b2f51504c65724947463468585a6442572f4e52745a5770784d554169787150526d646f4154684f4e666150413979394a2f307554760a47715434526655436759454132674a724b72536c7574634b444876584a2b496d6c556e755533514871356f4c4b4c654e6d546f4574364574414d467a73414b300a51352f72374772505a65684e624c64753171716473496d54427a36424e6433745a48773771492b444b4d4d3644486967716a78343861324549653850656665440a6e376637594952744b75614c727567624c422f4e4b7a504f4c63583931454c5549667345374d6745422f486d2f4b365a354571762f6a304367594541384d37480a61527a4862736e5a752f74614b7a336570454b6d74762b777a2f456e324a4a4247346771613369584e674a3844432b6d4c442f537330716c45704c6a51534e590a33726a653549764259654768546146413450376464766e41714d752b7055656d5955424d472b4c7846314979734a5547497267706b6c3944383335777a3568340a6e58795445434e4759666d4a363334506a7953736a4f6b746459576f3871446d642f3176524b30436759423646684b6e747352387a6f487448636b4f7038494e0a706e705674387533324b745a49506d6d446d796e3352585472344932316a7a5842673762746244786b396351412b574a5238444a4a54483251355765636572490a64423441746d577742537854345a5776332b2b6e414248583477576175766132456855764a746e76785734434243393756552f5457733669715a634e4d474f560a702f704a4533585763537832347479426b5358667a514b4267514376597173794431666868506f6b51366b6b6e576375303679413144462f41664533647934630a553077794168352f6f3865645349634b3632455758474e6c353733456a3234477154634e3167762b736b71394d356b4252683865724542357341736d62637a730a50397775343163633253303646772f6b386153316974542b337a5269766e58366e65537565454b6d30517832693958684e36444538482b2f664a33554f5151690a6d46385638514b4267426634505845346d377a5277756b4f305546595046664a797067665562727a657061506b354245487166475942464b2b6e71644e3372370a514e53467a355a594950766b724232413545796535776f3866793841535659436633473371544d4f356370465331762b544a727a6b474d674d5736752b646f2f0a7042634f5a437638613946685070687458502b4b62796b77796b7158486b4e3942672f35305844655648715155764368764f4f6d0a2d2d2d2d2d454e44205253412050524956415445204b45592d2d2d2d2d

RSA PUBLIC KEY:

2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145417a524a634f3671472f576e482f384d376f7157430a6a717168315558397a536a73394245496a4f2b7a52546a4d4a5378756f64446c79466d7a50565053672b54417835414b4d7775636d586562655a2f31646d7a360a577a66364f454f632f635a444367444c6856454e6a4f344b303946326a47414d30494269785a7870686a502f64352b686b30396e6e5331756f50656a457158540a42386b654a4a47626f334e43557150485434457a6d6e386a48347244704448557750696765547a697a33742f4255513661516a50796b75535634736b435139380a4e6158396644525a386242746b2f343771765236546b48786c356a2f646962333845596965642f363345366b4939325a314c4f58746854612f4776465959736e0a5452355161556b63335a4462322b6c365545455a794c586f53736d505062746a34435532596a48394f6a397463325165416136724b3566684250414a76656f440a4f514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d

(pycryptodome_pipenv) bash-3.2\$ ./rsa.py -e data.txt
2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145417a524a634f3671472f576e482f384d376f7157430a6a717168315558397a536a73394245496a4f2b7a52546a4d4a5378756f64446c79466d7a50565053672b54417835414b4d7775636d586562655a2f31646d7a360a577a66364f454f632f635a444367444c6856454e6a4f344b303946326a47414d30494269785a7870686a502f64352b686b30396e6e5331756f50656a457158540a42386b654a4a47626f334e43557150485434457a6d6e386a48347244704448557750696765547a697a33742f4255513661516a50796b75535634736b435139380a4e6158396644525a386242746b2f343771765236546b48786c356a2f646962333845596965642f363345366b4939325a314c4f58746854612f4776465959736e0a5452355161556b63335a4462322b6c365545455a794c586f53736d505062746a34435532596a48394f6a397463325165416136724b3566684250414a76656f440a4f514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d

(pycryptodome_pipenv) bash-3.2\$ cat data.txt 

??QW?"\\

       –?????ۑy????

\\??;?k?fw?\#u?\@???N3?Ϛ1SPA!???C???Z?P\|{???q????\<?????V锸??HYV?3.'??0\~'?ТjI?Ј?S?mn??•'J\*0V??5?D%

??q??Hu?z???O???V??0??}X?Q?Tfs?ނy????,?h{?}?\`By?X7C????+?oww??OQҦG8?J?oףg???b???\#?8Ց?????\<»??kru-???2t?????JG?1f?(pycryptodome_pipenv)
bash-3.2\$ 

(pycryptodome_pipenv) bash-3.2\$ ./rsa.py -d data.txt
2d2d2d2d2d424547494e205253412050524956415445204b45592d2d2d2d2d0a4d4949456f77494241414b43415145417a524a634f3671472f576e482f384d376f7157436a717168315558397a536a73394245496a4f2b7a52546a4d4a5378750a6f64446c79466d7a50565053672b54417835414b4d7775636d586562655a2f31646d7a36577a66364f454f632f635a444367444c6856454e6a4f344b303946320a6a47414d30494269785a7870686a502f64352b686b30396e6e5331756f50656a4571585442386b654a4a47626f334e43557150485434457a6d6e386a483472440a704448557750696765547a697a33742f4255513661516a50796b75535634736b435139384e6158396644525a386242746b2f343771765236546b48786c356a2f0a646962333845596965642f363345366b4939325a314c4f58746854612f4776465959736e5452355161556b63335a4462322b6c365545455a794c586f53736d500a5062746a34435532596a48394f6a397463325165416136724b3566684250414a76656f444f51494441514142416f494241426e61642f624d755a352b704d68310a6a6c486a77466b6f6f57547749543570613741636171484d41574f58644d4d312f672b58394c516b764f42644c6a5054466376432b4d6f314b303238777354620a576669505a694f305936384f74523759545444595a3141634a784e756d6a35596b4c5044557a4a4245564b38394a2f47382b7a616d75586c73356767393272440a4e5a4f66424d4d64513566554a4a552f625776614f6f456e4e6f434354327a33474c5a66645879437244586279385a51364a4b3973565068782f4535635759550a4c4d6f34632f74384a412b736c4e2b666f572f464f693442384a6a7875774b31747673783847734f5950487a6e545949492b37756345574d35715164484953340a303566494d73767958466b2f51504c65724947463468585a6442572f4e52745a5770784d554169787150526d646f4154684f4e666150413979394a2f307554760a47715434526655436759454132674a724b72536c7574634b444876584a2b496d6c556e755533514871356f4c4b4c654e6d546f4574364574414d467a73414b300a51352f72374772505a65684e624c64753171716473496d54427a36424e6433745a48773771492b444b4d4d3644486967716a78343861324549653850656665440a6e376637594952744b75614c727567624c422f4e4b7a504f4c63583931454c5549667345374d6745422f486d2f4b365a354571762f6a304367594541384d37480a61527a4862736e5a752f74614b7a336570454b6d74762b777a2f456e324a4a4247346771613369584e674a3844432b6d4c442f537330716c45704c6a51534e590a33726a653549764259654768546146413450376464766e41714d752b7055656d5955424d472b4c7846314979734a5547497267706b6c3944383335777a3568340a6e58795445434e4759666d4a363334506a7953736a4f6b746459576f3871446d642f3176524b30436759423646684b6e747352387a6f487448636b4f7038494e0a706e705674387533324b745a49506d6d446d796e3352585472344932316a7a5842673762746244786b396351412b574a5238444a4a54483251355765636572490a64423441746d577742537854345a5776332b2b6e414248583477576175766132456855764a746e76785734434243393756552f5457733669715a634e4d474f560a702f704a4533585763537832347479426b5358667a514b4267514376597173794431666868506f6b51366b6b6e576375303679413144462f41664533647934630a553077794168352f6f3865645349634b3632455758474e6c353733456a3234477154634e3167762b736b71394d356b4252683865724542357341736d62637a730a50397775343163633253303646772f6b386153316974542b337a5269766e58366e65537565454b6d30517832693958684e36444538482b2f664a33554f5151690a6d46385638514b4267426634505845346d377a5277756b4f305546595046664a797067665562727a657061506b354245487166475942464b2b6e71644e3372370a514e53467a355a594950766b724232413545796535776f3866793841535659436633473371544d4f356370465331762b544a727a6b474d674d5736752b646f2f0a7042634f5a437638613946685070687458502b4b62796b77796b7158486b4e3942672f35305844655648715155764368764f4f6d0a2d2d2d2d2d454e44205253412050524956415445204b45592d2d2d2d2d

(pycryptodome_pipenv) bash-3.2\$ cat data.txt 

confidential information
